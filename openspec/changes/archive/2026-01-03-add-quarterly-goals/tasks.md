# 实现任务清单

## 1. 数据层实现
- [x] 1.1 在 `lib/storage.js` 中添加 `quarterlyGoals` 数据合并方法 `mergeQuarterlyGoals`
- [x] 1.2 在 `mergeData` 方法的 switch 语句中添加 `quarterlyGoals` case
- [x] 1.3 在 `exportAllData` 方法中添加季度目标数据导出
- [x] 1.4 验证数据持久化：LocalStorage 存储和读取
- [x] 1.5 验证服务器备份：自动备份和恢复机制

## 2. 进度计算逻辑实现
- [x] 2.1 在 `app/page.js` 中实现 `calculateYearlyGoalProgress` 函数（根据关联的季度目标加权计算年度目标进度）
- [x] 2.2 实现季度目标变更时触发年度目标进度更新的机制
- [x] 2.3 实现季度目标删除时触发年度目标进度更新的机制
- [x] 2.4 处理权重总和不为 100% 的情况（归一化处理）
- [x] 2.5 处理年度目标没有关联季度目标时的手动进度模式

## 3. 季度目标 UI 组件实现
- [x] 3.1 创建 `components/quarterly-goals-tracker.js` 组件文件
- [x] 3.2 实现季度目标列表视图（参考 yearly-goals-tracker 的布局）
- [x] 3.3 实现添加季度目标表单（标题、描述、年份、季度、关联年度目标、权重占比、标签选择）
- [x] 3.4 实现季度筛选器（Q1、Q2、Q3、Q4 切换）
- [x] 3.5 实现年度目标关联选择器（下拉选择，显示同年份的年度目标）
- [x] 3.6 实现权重占比输入（0-100，提示当前年度目标已分配的权重）
- [x] 3.7 实现进度条组件（百分比滑块或输入）
- [x] 3.8 实现季度目标卡片（显示标题、描述、进度、权重、关联的年度目标、标签、季度）
- [x] 3.9 实现季度目标编辑功能
- [x] 3.10 实现季度目标删除功能（带确认提示，并说明会影响关联的年度目标进度）
- [x] 3.11 添加动画效果（使用 Framer Motion）
- [x] 3.12 添加音频反馈（目标完成时播放完成音效）

## 4. 年度目标 UI 更新
- [x] 4.1 修改 `components/yearly-goals-tracker.js`，添加"关联的季度目标"显示区域
- [x] 4.2 在年度目标卡片上显示关联的季度目标数量
- [x] 4.3 显示进度来源标识（"手动设置" vs "自动计算"）
- [x] 4.4 当年度目标有关联的季度目标时，禁用手动进度编辑
- [x] 4.5 添加查看关联季度目标的快捷入口（点击后跳转到季度目标视图并筛选）

## 5. 主应用集成
- [x] 5.1 在 `app/page.js` 中添加 `quarterlyGoals` state
- [x] 5.2 添加 `showQuarterlyGoals` modal state
- [x] 5.3 在数据加载 useEffect 中添加季度目标加载逻辑
- [x] 5.4 在数据保存 useEffect 中添加季度目标保存逻辑
- [x] 5.5 实现 `addQuarterlyGoal` 函数（包含进度更新逻辑）
- [x] 5.6 实现 `updateQuarterlyGoal` 函数（包含进度更新逻辑）
- [x] 5.7 实现 `deleteQuarterlyGoal` 函数（包含进度更新逻辑）
- [x] 5.8 在底部导航栏或设置中添加"季度目标"入口按钮
- [x] 5.9 集成 QuarterlyGoalsTracker 组件到 AnimatePresence
- [x] 5.10 在 `exportData` 函数中添加季度目标导出
- [x] 5.11 在 `importData` 函数中添加季度目标导入
- [x] 5.12 添加键盘快捷键（如 Ctrl/Cmd + Q）打开季度目标

## 6. 样式和主题
- [x] 6.1 确保季度目标组件样式与现有主题系统兼容（使用相同的样式系统）
- [x] 6.2 测试深色/浅色模式切换（使用 CSS 变量和 Tailwind 类）
- [x] 6.3 测试 4 种主题下的显示效果（继承主题系统）
- [x] 6.4 确保响应式设计（移动端和桌面端）（使用响应式布局）
- [x] 6.5 添加季度目标与年度目标的视觉区分（使用不同的图标和标签）

## 7. 测试和验证
- [x] 7.1 测试季度目标的创建、编辑、删除流程
- [x] 7.2 测试进度更新和可视化
- [x] 7.3 测试年度目标关联和权重设置
- [x] 7.4 测试自动进度计算（单个季度目标、多个季度目标、权重归一化）
- [x] 7.5 测试权重总和超过或不足 100% 的情况
- [x] 7.6 测试删除季度目标后年度目标进度更新
- [x] 7.7 测试数据持久化（刷新页面后数据保留）
- [x] 7.8 测试服务器备份和恢复（隐身模式、新设备）
- [ ] 7.9 测试数据导出和导入功能
- [x] 7.10 测试键盘快捷键
- [x] 7.11 测试季度筛选和年份切换功能
- [x] 7.12 测试标签系统集成
- [x] 7.13 测试年度目标手动模式和自动模式的切换

## 8. 文档更新
- [x] 8.1 更新 README.md 添加季度目标功能说明
- [x] 8.2 更新 DATA_MANAGEMENT.md 添加 quarterlyGoals 数据说明
- [x] 8.3 更新 CLAUDE.md 添加季度目标数据结构说明
- [x] 8.4 添加年度目标和季度目标关联关系的说明
- [x] 8.5 添加自动进度计算机制的说明

